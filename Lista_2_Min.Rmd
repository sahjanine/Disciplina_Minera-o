---
title: "Lista 2 de Mineração"
author: "Rhayani, Samantha e Thais"
date: "24/10/2021"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, results = "hide",message = FALSE,warning=FALSE}

#carregando pacotes

library(readr)
library(dplyr)
library(glmnet)
library(tm)
library(FNN)
library(ranger)
library(ggplot2)
library(ggpubr)
library(xgboost)
```

# Exercício 2

## Item A

Primeiramente, antes de fazer os exercícios sugeridos da lista, os dados (denominado pelo grupo como *filmes*) foram analisados com o intuito de entender e visualizar a seu respeito e como foram identificados alguns valores contendo NA's, essas observações foram retiradas da base (ao todo, foram identificados 30 descrições ausentes).


```{r}
#carregando os dados

filmes<- read_csv("C:/Users/011694631/Downloads/TMDb_updated.CSV")

#verificando NA
filmes<-na.omit(filmes) #30 NAs

#Pré processamento

#Cria a matriz documento termo

texto <- VCorpus(VectorSource(filmes$overview))

mdc <- DocumentTermMatrix(texto,
                          control = list(tolower = TRUE, 
                                         stemming = FALSE,
                                         removeNumbers = TRUE,
                                         removePunctuation = TRUE,
                                         removeStripwhitespace = TRUE,
                                         weighting = weightTf,
                          bounds=list(global=c(100,Inf)))) 
#seleciona os termos que aparecem em mais que 100 resenhas

#matriz documento termo em formato matricial

dtm_mat<-mdc%>%as.matrix()

#matriz esparsa

dtmMatrix <- sparseMatrix(i = mdc$i, j = mdc$j, x = mdc$v,
                          dimnames = list(NULL, mdc$dimnames[[2]]),
                          dims = c(mdc$nrow, mdc$ncol))

#divisão dos dados

set.seed(26) #semente escolhida

split<-sample(c("Treinamento","Validação","Teste"),
              prob=c(0.6,0.2,0.2), size=nrow(filmes), replace=TRUE)


```

Nesse exercício dividimos os dados em treino, validação e teste. A base de treino é a que contém a maior porcentagem (60\%), pois iremos utilizá-la para o ajuste do modelo e nesse caso, quanto mais dados, melhor o ajuste. 

A base de validação será utilizada para encontrar alguns parâmetros que serão utilizados no ajuste do modelo, para essa função consideramos uma base com 20\% do tamanho original, porque o tamanho dela é relativamente grande, sendo uma volumetria adequada.

Por fim, a base de teste também representa 20\% da base original, como essa parte será utilizada para calcular o risco que é uma média, 20\% é um tamanho razoável para a base de teste, tendo em vista que existem 9970 observações nos dados originais.

## Item B

```{r}
#KNN

k.grid<-round(seq(1,50,length.out=10)) #declarando um grid de k a ser utilizado

erro<-rep(NA,length(k.grid))

#ajustando um lasso para validação cruzada

for (ii in seq_along(k.grid)) {
  predito<- knn.reg(train = rbind(dtm_mat[split=="Treinamento",],dtm_mat[split=="Validação",]),                     y=c(filmes$vote_average[split=="Treinamento"],                      filmes$vote_average[split=="Validação"]),
                    k=k.grid[ii])$pred
  
  erro[ii] <- mean((predito-c(filmes$vote_average[split=="Treinamento"],
filmes$vote_average[split=="Validação"]))^2)
  
}

plot(k.grid,erro,col="red",pch=16,main = "Gráfico Kgrid X Erro",ylab = "Erro",xlab="Kgrid")

melhor_k<-k.grid[which.min(erro)]
melhor_k #melhor kgrid selecionado 

predito<- knn.reg(train=rbind(dtm_mat[split=="Treinamento",],dtm_mat[split=="Validação",]),
                  test = dtm_mat[split=="Teste",],
  y=c(filmes$vote_average[split=="Treinamento"],
      filmes$vote_average[split=="Validação"]),
                  k=melhor_k)$pred


riscos_knn <- (predito-filmes$vote_average[split=="Teste"])^2%>%mean()
riscos_knn #risco do KNN

m=length(filmes$vote_average[split=="Teste"])
w=(predito-filmes$vote_average[split=="Teste"])^2
sigma_w=(w-mean(w))^2 %>% mean()

erro_padrao_knn=sqrt(sigma_w/m)
erro_padrao_knn #erro padrão knn

Medidas <- data.frame(riscos_knn,erro_padrao_knn)
row.names(Medidas) <- c("Medidas")
knitr::kable(Medidas, col.names = c("Risco","Erro padrão") , align = "c",digits = 4)

```

O método dos k-vizinhos mais próximos, também conhecido como KNN, como explicado no livro Aprendizado de Máquina: Uma abordagem estatística do professor, possui como finalidade estimar a função de regressão $r(x)$ para uma
dada configuração das covariáveis $x$ com base nas respostas $Y$ dos $k$-vizinhos mais
próximos a $x$.

Para saber qual o melhor $k$, foi utilizada a função "k.grid[which.min(erro)]" a partir do desenvolvimento realizado para encontrar os preditos e os erros. Também é possível visualizar essa informação a partir do gráfico.

Com o valor de $k$ encontrado, a função predito faz a predição para novas observações e conseguimos encontrar a partir disso o valor do risco e do erro padrão. 

O risco obtido pelo KNN foi de 2.0003. Ainda não é possível afirmar se este apresenta um desempenho ruim em relação aos demais, porém isso pode acontecer dado que ele leva em consideração todas as variáveis do banco de dados filmes e não faz nenhum tipo de seleção. Um exemplo, é que a linguagem original do filme é considerada igualmente e para a variável resposta, essa variável pode não ser tão interessante. Porém, isso será relembrado caso obtivermos melhores valores do risco nos outros métodos.

## Item C

```{r}

####Lasso
cv_lasso<- cv.glmnet(rbind(dtm_mat[split=="Treinamento",],dtm_mat[split=="Validação",]),                     c(filmes$vote_average[split=="Treinamento"],               filmes$vote_average[split=="Validação"]),
                     alpha = 1)

cv_lasso$lambda.min #lambda escolhido

plot(cv_lasso)

ajuste_lasso=glmnet(rbind(dtm_mat[split=="Treinamento",],dtm_mat[split=="Validação",]),                    c(filmes$vote_average[split=="Treinamento"],              filmes$vote_average[split=="Validação"]),
  alpha=1,
  lambda=cv_lasso$lambda.min)

coef_lasso=ajuste_lasso %>% coef.glmnet() %>% as.matrix %>% data.frame()

#knitr::kable(coef_lasso[,order(s0)],col.names = "Coef. Lasso",align = "c")

predito_lasso<- predict(cv_lasso, s=cv_lasso$lambda.min,
                        newx=dtm_mat[split=="Teste",] )

risco_lasso<- (predito_lasso - filmes$vote_average[split=="Teste"])^2%>%mean()
risco_lasso #risco do lasso


#variaveis escolhidas
table(coef(cv_lasso,s=cv_lasso$lambda.min)[,1]!=0)

estima_coef<- coef(cv_lasso,s=cv_lasso$lambda.min)
coefs<- estima_coef%>% as.matrix()%>% as_tibble()
names(coefs)="Estimativa"

coefs%>%mutate(variavel=rownames(estima_coef))%>%
  arrange(desc(abs(Estimativa)))

theme_set(theme_gray(base_size=18))

estima_coef<- data.frame(Palavra=rownames(estima_coef),
                         Coeficientes= estima_coef[,1])

coef_pos<-estima_coef%>% arrange(desc(Coeficientes))

coef_neg <- estima_coef%>% arrange(Coeficientes)

graf_pos<- ggplot(data=coef_pos[2:30,],aes(x=reorder(Palavra,
                                                     Coeficientes),y=Coeficientes))+
  geom_bar(stat="identity",col="white",fill="dodgerblue1")+coord_flip()+
  xlab("")+ylab("Estimativa")+ggtitle("Coeficientes Positivos")+
  theme( plot.title = element_text(hjust = 0.4),
         axis.title = element_text(size = 11),
         axis.text = element_text(size = 13), 
         title =  element_text(size = 10) ) 

graf_neg<- ggplot(data=coef_neg[1:30,],aes(x=reorder(Palavra,
                                                     -Coeficientes),y=Coeficientes))+
  geom_bar(stat="identity",col="white",fill="red")+coord_flip()+
  xlab("Termo")+ylab("Estimativa")+ggtitle("Coeficientes Negativos")+
  theme( plot.title = element_text(hjust = 0.4),
         axis.title = element_text(size = 11),
         axis.text = element_text(size = 13), 
         title =  element_text(size = 10) ) 

ggarrange(graf_neg,graf_pos,ncol = 2,nrow = 1)

```

Na Figura acima, temos os coeficientes relacionados às palavras que mais se destacam positivamente (à direita) e negativamente (à esquerda). Analisando as estimativas dos coeficientes positivos, as 6 palavras mais relevantes para explicação da nota do filme foram:  *village, despite, war, french, friendship e falls*. Os 6 maiores coeficientes negativos, por sua vez, são referentes as palavras: *plot, evil, dangerous, deadly, movie e dark*. 

Algumas palavras não tem tantas interpretações, como *movie* que deve ter sido significativa apenas pelo estudo ser baseado em filmes. Em contrapartida, podemos ver que filmes que contem algumas características relacionadas a *vila, guerra, françês e amizade* podem ter uma nota maior, já que essas palavras tem os maiores coeficientes.

Além disso, observamos que os termos *enredo, perigo e morte* são palavras com coeficientes baixos, o que diminui a nota do filme. Talvez isso signifique que um enredo pode ser muito significante para a aprovação do público e que talvez esse público não goste de filmes com *perigo e morte*, como os de terror.

```{r}
m=length(filmes$vote_average[split=="Teste"])
w=(predito_lasso-filmes$vote_average[split=="Teste"])^2
sigma_w=(w-mean(w))^2 %>% mean()
erro_padrao_lasso=sqrt(sigma_w/m)

Medidas <- data.frame(risco_lasso,erro_padrao_lasso)
row.names(Medidas) <- c("Medidas")
knitr::kable(Medidas, col.names = c("Risco","Erro padrão") , align = "c",digits = 4)

```

Ao realizar a técnica do Lasso, observa-se um valor de risco menor em relação ao KNN (o que já era esperado). Com um risco de 1.67 (lembrando que para chegar nesse valor, foi utilizado o melhor valor de $\lambda$), temos que a princípio essa técnica possui um risco menor, os erros de ambas são bem próximos se alterando apenas com uma diferença de 0,0167 de um erro padrão para outro.

## Item D

```{r}

#Floresta Aleatória

dados_tudo=dtm_mat %>% as.data.frame() %>% mutate(Nota=filmes$vote_average)

names(dados_tudo) = make.names(names(dados_tudo))

floresta=ranger(Nota~.,data=rbind(dados_tudo[split=="Treinamento",],
                                  dados_tudo[split=="Validação",]),
                importance = "impurity")

#predito
predito_floresta=predict(floresta,dados_tudo[split=="Teste",])

risco_floresta=(predito_floresta$predictions-dados_tudo$Nota[split=='Teste'])^2 %>% mean()
risco_floresta #risco floresta

importancia = tibble(variable=names(importance(floresta)),
                     importance=importance(floresta)) %>% arrange(desc(importance))


ggplot(importancia %>% top_n(n=20),aes(x=reorder(variable,importance),
                                       y=importance))+
  geom_bar(stat="identity",position = 'dodge')+coord_flip()+
  ylab("Importância")+xlab("")+ggtitle("Resumo")+guides(fill="none")+
  scale_fill_gradient(low="red",high="blue")

```

A partir do gráfico de importância das covariáveis, é possível notar que as variáveis que mais foram importantes para o ajuste se diferem em relação às obtidas pelo estimador linear. Podemos notar que a palavra com maior importância é o artigo definido *the*. Tal fato pode ser justificado por ser um artigo que acompanha substantivos que possam ser utilizados para classificar o filme. Para os demais termos podemos notar pronomes como *his, her, their* além de outras palavras como *and, with, for, from, that*, as quais não há explicações razoáveis para serem importantes à princípio. 

Ainda, podemos identificar que os termos em comum considerados importantes na floresta e no lasso foram *plot, movie, life e story*, isto é, conforme comentado anteriormente, o enredo do filme tem uma importância para a nota atribuída ao filme.

```{r}
m=length(filmes$vote_average[split=="Teste"])
w=(predito_floresta$predictions-dados_tudo$Nota[split=='Teste'])^2
sigma_w=(w-mean(w))^2 %>% mean()
erro_padrao_flo=sqrt(sigma_w/m)

Medidas <- data.frame(risco_floresta,erro_padrao_flo)
row.names(Medidas) <- c("Medidas")
knitr::kable(Medidas, col.names = c("Risco","Erro padrão") , align = "c",digits = 4)

```

O risco obtido pelo método da floresta foi o melhor até o momento, com o resultado de 1.6478. O erro padrão é de 0.1256, menor que o erro obtido pelo lasso.

## Item E

```{r,results = "hide",message = FALSE,warning=FALSE}
xgb_boost = xgboost(data = rbind(dtmMatrix[split=="Treinamento",],
                             dtmMatrix[split=="Validação",]),
                label = c(filmes$vote_average[split=="Treinamento"],
   filmes$vote_average[split=="Validação"]),
                nrounds = 1000,
                nfold = 5,
                eta = 0.01,
                early_stopping_rounds = 20,
                verbose = F)

# Identificando as palavras por importância

imp_xgboost = xgb.importance(colnames(rbind(dtmMatrix[split=="Treinamento",],
                              dtmMatrix[split=="Validação",])), model = xgb_boost)

imp_xgb = imp_xgboost[,c(1,2)]

colnames(imp_xgb) = c("variable","importance")

imp_xgb = as.data.frame(imp_xgb)

importance_x<- imp_xgb %>% arrange(desc(importance))

ggplot(importance_x%>% top_n(n=20),
       aes(x=reorder(variable,importance), y=importance))+
  geom_bar(stat="identity",position="dodge")+ coord_flip()+
  ylab("Importância da variável")+xlab("")+
  ggtitle("Information Value Summary")+
  guides(fill=F)
```

Para identificar as palavras que possuem maior importância para o método XGBoost, foi utilizada a função "xgb.importance" que retorna a palavra em si e a contribuição de cada uma para o modelo. Com isso, identificamos três palavras que têm uma importância maior em relação as demais, que são: *and, the e plot*. Mais uma vez, o enredo do filme é importante para a nota atribuída ao filme.

Outras palavras, com importâncias menores, porém que estão acima das demais são: *film, world, family, dangerous, friendship, captain, race, career e turns*. Identifica-se que para essa técnica, a avaliação da nota atribuída ao filme se caracteriza por filmes que envolvam família e amizade (podendo ser de comédia), perigo (caracterizando como o terror) e outras características como captão, raça, carreiras, mundo. Palavras como *for, her, when, after, from e about* não acrescentam muito a respeito de uma característica específica do filme.

Não houve nenhuma palavra significativa que realmente acrescentasse no modelo que aparecesse nos três métodos utilizados, porém foram encontradas algumas intersecções: a palavra *mundo* aparece nessa técnica juntamente com a da floresta; as palavras *amizade, perigo e enredo* aparecem também na técnica do Lasso.

```{r,message = FALSE,warning=FALSE}
pred_xgboost <- predict(xgb_boost, dtmMatrix[split=="Teste",])

risco_boost<- (pred_xgboost - filmes$vote_average[split=="Teste"])^2%>%mean()

m=length(filmes$vote_average[split=="Teste"])
w=(pred_xgboost-filmes$vote_average[split=="Teste"])^2
sigma_w=(w-mean(w))^2 %>% mean()
erro_padrao_boost=sqrt(sigma_w/m)

Medidas <- data.frame(risco_boost,erro_padrao_boost)
row.names(Medidas) <- c("Medidas")
knitr::kable(Medidas, col.names = c("Risco","Erro padrão") , align = "c",digits = 4)

```

O método de XGBoost apresentou um risco de 1.7003, sendo maior que o do lasso e o da floresta. O erro obtido foi de 0.128, próximo do obtido pelos outros dois métodos. Logo, podemos fazer uma pré-conclusão que a técnica do XGBoost não é a ideal para ajustar esse conjunto de dados a respeito dos filmes.

## Item F

Para verificar o comportamento de redes neurais, foi utilizado a técnica na plataforma online Colab, que permitia uma aplicação mais eficiente do método. Com isso, foram definidos todos os valores da estrutura dos preditos de redes neurais e nosso interesse é identificar o risco e o erro padrão em comparação com os demais.

```{r, echo=FALSE}

#redes neurais

predito_redes<-structure(c(6.71816825866699, 6.32817697525024, 6.92468214035034, 
6.7145733833313, 6.54663515090942, 6.790207862854, 6.99159622192383, 
6.69139432907104, 6.55159425735474, 6.00793123245239, 6.4245662689209, 
6.46292448043823, 6.84501028060913, 6.2032995223999, 6.43829298019409, 
6.66115808486938, 5.99986934661865, 6.64740037918091, 5.31708526611328, 
5.87834119796753, 6.19529008865356, 7.65082502365112, 5.57351398468018, 
6.00998258590698, 6.70106840133667, 7.34711074829102, 5.28211784362793, 
7.14136457443237, 6.85287046432495, 5.65993547439575, 6.89320230484009, 
6.91684293746948, 6.38916349411011, 6.13953733444214, 6.42648601531982, 
6.17736291885376, 5.42068672180176, 6.71755409240723, 7.599289894104, 
5.8697075843811, 7.59478998184204, 6.07291650772095, 6.90051889419556, 
6.25361061096191, 5.85876798629761, 7.213303565979, 6.45486354827881, 
6.12936592102051, 6.54042720794678, 7.56259346008301, 5.93224239349365, 
6.23358678817749, 6.42895603179932, 6.165931224823, 6.88077449798584, 
6.24767589569092, 5.4602427482605, 5.53490877151489, 5.92662858963013, 
5.62250757217407, 7.09680843353271, 6.36310529708862, 6.24087142944336, 
7.3538556098938, 5.39623975753784, 6.26063966751099, 6.91311550140381, 
5.25903749465942, 5.93008136749268, 5.73533487319946, 6.13699913024902, 
7.2303581237793, 5.88488960266113, 6.65260410308838, 6.35895824432373, 
8.17522048950195, 6.11979341506958, 6.41713905334473, 5.49732828140259, 
6.28087568283081, 6.1569561958313, 5.4791955947876, 7.01161336898804, 
4.73086357116699, 6.09083318710327, 5.93388414382935, 6.57416391372681, 
6.23341989517212, 5.85711145401001, 6.31989812850952, 7.0744571685791, 
5.52820014953613, 5.40076494216919, 6.01968097686768, 6.2220025062561, 
6.1026439666748, 6.74368095397949, 6.65949440002441, 6.30369901657104, 
6.25707626342773, 5.67854022979736, 6.95219564437866, 6.71017599105835, 
6.63954019546509, 6.28293561935425, 5.62672424316406, 6.21333265304565, 
6.30812215805054, 5.00696134567261, 6.55472373962402, 6.3804178237915, 
7.44880771636963, 6.67750215530396, 6.71840572357178, 5.69881534576416, 
6.7633695602417, 6.74119186401367, 6.41771841049194, 6.62483072280884, 
6.64149904251099, 5.81340408325195, 7.7505087852478, 6.13808107376099, 
5.64632368087769, 6.05851316452026, 4.94417905807495, 4.76537227630615, 
6.03163766860962, 5.66636180877686, 6.6974835395813, 6.21524572372437, 
6.0437707901001, 5.56965446472168, 6.30301475524902, 5.34642553329468, 
6.78464651107788, 8.50480651855469, 4.84862947463989, 8.06910037994385, 
5.7335319519043, 5.74351692199707, 6.19708299636841, 6.29168462753296, 
6.55702829360962, 6.7605996131897, 5.9967565536499, 5.7578010559082, 
5.54775953292847, 7.21263313293457, 5.82811260223389, 5.72049951553345, 
5.81666088104248, 6.94340848922729, 6.33101844787598, 7.1052451133728, 
5.95103406906128, 6.60263347625732, 6.33469867706299, 6.63815546035767, 
6.9337043762207, 5.35010766983032, 6.63121223449707, 5.39090442657471, 
7.17436122894287, 6.0255651473999, 5.72072553634644, 6.09196424484253, 
6.24583625793457, 6.31356620788574, 7.05987596511841, 6.6544132232666, 
5.66278314590454, 7.00532341003418, 5.99625682830811, 6.69109773635864, 
6.65589427947998, 5.71962118148804, 6.03081560134888, 6.23201465606689, 
7.69163084030151, 7.4019718170166, 6.41782569885254, 7.52785110473633, 
6.4463095664978, 5.97612857818604, 6.01845073699951, 5.01908922195435, 
6.29144811630249, 6.46474123001099, 7.11362791061401, 6.1827654838562, 
6.9038782119751, 6.05628204345703, 6.00039529800415, 5.61212110519409, 
6.77089881896973, 6.73336458206177, 5.92739200592041, 6.59633159637451, 
6.33152961730957, 7.612473487854, 5.89323806762695, 6.97384548187256, 
7.94995737075806, 6.22548627853394, 6.33169651031494, 5.66943883895874, 
7.07651281356812, 5.70239400863647, 5.49067544937134, 6.88377618789673, 
6.38201808929443, 5.91161155700684, 6.32452011108398, 6.20841407775879, 
7.04460668563843, 6.16181945800781, 6.34159374237061, 5.44888353347778, 
5.69452857971191, 6.73976182937622, 5.69053363800049, 4.66730785369873, 
6.06724643707275, 5.72537755966187, 6.84288883209229, 6.69941663742065, 
6.18402862548828, 7.36822891235352, 5.82487916946411, 5.22706604003906, 
6.48591995239258, 7.60900831222534, 7.20518684387207, 6.28830337524414, 
6.75253582000732, 7.43659925460815, 6.05611228942871, 8.42766952514648, 
7.6803297996521, 6.97948122024536, 6.41787672042847, 6.59313106536865, 
5.66284656524658, 6.30116653442383, 6.49517869949341, 6.74319410324097, 
7.05064678192139, 6.52715492248535, 6.16174507141113, 5.43460464477539, 
6.5458664894104, 4.72065591812134, 6.24952030181885, 7.13001346588135, 
6.44334650039673, 5.11982727050781, 5.51334381103516, 6.47319173812866, 
6.51446485519409, 6.45659637451172, 6.39955472946167, 7.64629173278809, 
6.41082286834717, 6.77874422073364, 5.46947336196899, 5.78956079483032, 
5.59037351608276, 6.27856922149658, 6.58540201187134, 7.02870416641235, 
7.0215539932251, 5.84506797790527, 5.71776247024536, 6.96313095092773, 
6.9535117149353, 6.59393501281738, 6.02597999572754, 6.0525951385498, 
5.774254322052, 5.37237119674683, 6.73459529876709, 5.85157775878906, 
5.22069358825684, 6.14829063415527, 6.29658222198486, 7.24687910079956, 
6.63633441925049, 5.96461868286133, 7.21334028244019, 6.32044887542725, 
6.12094497680664, 7.24900960922241, 5.3939790725708, 6.63564586639404, 
5.82336568832397, 6.08226203918457, 5.77259731292725, 7.36638832092285, 
6.21285152435303, 6.28737878799438, 6.31741237640381, 5.3717622756958, 
6.27588033676147, 6.27984046936035, 7.16359233856201, 5.43755292892456, 
5.96642875671387, 6.57651901245117, 6.05347585678101, 6.75464057922363, 
6.94849634170532, 5.80932092666626, 6.04515647888184, 6.61328554153442, 
5.82109117507935, 7.09391403198242, 5.55677652359009, 7.40396451950073, 
5.64756727218628, 6.53310585021973, 5.62562704086304, 6.88535642623901, 
7.81939792633057, 7.56949758529663, 6.53540325164795, 8.31657791137695, 
5.83087205886841, 6.94953918457031, 6.2278356552124, 5.28671264648438, 
6.4856014251709, 5.80367708206177, 6.01326608657837, 6.68934488296509, 
5.71540403366089, 6.20953989028931, 5.72431182861328, 7.30268907546997, 
7.80953979492188, 6.07333087921143, 4.70549774169922, 5.82761335372925, 
5.18984079360962, 5.53940057754517, 6.88958024978638, 5.95345592498779, 
6.77778482437134, 5.99993276596069, 6.50632381439209, 6.39423179626465, 
5.78892850875854, 6.01055526733398, 5.94555521011353, 6.60044193267822, 
5.72698545455933, 6.16735363006592, 6.34418916702271, 5.6942925453186, 
6.90072011947632, 6.84492111206055, 6.59066534042358, 8.1939525604248, 
6.55812072753906, 5.37985372543335, 6.19810152053833, 6.1756443977356, 
6.12608337402344, 6.46886920928955, 6.0358419418335, 6.37721347808838, 
5.91184854507446, 6.50167942047119, 6.03279495239258, 6.6964259147644, 
6.38879156112671, 6.15119981765747, 6.44488620758057, 6.71002388000488, 
6.77900171279907, 7.32850980758667, 6.79841470718384, 5.92094659805298, 
6.14247703552246, 7.05816459655762, 7.1450834274292, 5.84831380844116, 
4.49607753753662, 6.60140228271484, 6.82916212081909, 6.10082101821899, 
5.94764471054077, 7.47733116149902, 6.99849605560303, 6.84425449371338, 
7.01784706115723, 7.18965578079224, 5.93585252761841, 5.66546487808228, 
6.00359201431274, 5.89560794830322, 5.905113697052, 6.31880569458008, 
6.7172999382019, 5.16596508026123, 6.30386734008789, 6.53381681442261, 
7.07942724227905, 5.9447603225708, 6.53087139129639, 5.67414999008179, 
5.57019901275635, 7.54640483856201, 6.36705827713013, 5.76012325286865, 
5.60878610610962, 6.4412636756897, 6.4232702255249, 6.04932451248169, 
6.6307635307312, 6.55665445327759, 5.90476751327515, 6.11749792098999, 
6.74798011779785, 5.71642351150513, 5.98551321029663, 6.07426786422729, 
6.27116012573242, 5.7792272567749, 6.18293857574463, 6.21213912963867, 
7.1274676322937, 5.96158504486084, 6.42212963104248, 6.98683595657349, 
7.65358018875122, 6.70736169815063, 6.26391935348511, 6.51175355911255, 
6.49912738800049, 5.46807622909546, 7.23205375671387, 6.51243114471436, 
6.10220241546631, 7.5870566368103, 6.37494516372681, 6.64454460144043, 
6.53898572921753, 5.36853075027466, 6.38352394104004, 7.25240421295166, 
6.15636348724365, 5.42780494689941, 6.24039459228516, 6.43736886978149, 
5.49675846099854, 7.21960544586182, 5.84594535827637, 6.13476085662842, 
7.75437784194946, 6.01385450363159, 5.8736686706543, 6.33375310897827, 
6.44781303405762, 5.17229747772217, 6.16822052001953, 5.9827938079834, 
6.05711889266968, 5.02218389511108, 6.91295480728149, 5.76050090789795, 
6.29169178009033, 6.24543190002441, 7.46958065032959, 6.1181755065918, 
6.3198184967041, 6.21716117858887, 7.55516862869263, 6.46642875671387, 
6.56632804870605, 5.83040380477905, 5.69650650024414, 6.82656574249268, 
7.67661666870117, 5.08387660980225, 6.67697286605835, 6.98981857299805, 
5.50498104095459, 6.10060882568359, 6.87905406951904, 7.43827104568481, 
6.68356895446777, 6.37198925018311, 6.41436243057251, 6.59009981155396, 
5.97371864318848, 5.38276195526123, 6.13637161254883, 6.3590874671936, 
5.45793056488037, 6.07753467559814, 6.47582101821899, 6.83129692077637, 
6.97114372253418, 6.14756536483765, 5.72796010971069, 5.72260284423828, 
6.90830850601196, 7.42984104156494, 5.88849449157715, 6.33247709274292, 
7.65913009643555, 5.9486083984375, 5.52122259140015, 6.33815002441406, 
6.8708381652832, 7.21197557449341, 6.02423810958862, 5.91526222229004, 
6.43926620483398, 7.05944585800171, 6.56759166717529, 6.17545318603516, 
6.29348754882812, 6.63687658309937, 5.96131896972656, 7.5810923576355, 
6.48179340362549, 5.60372161865234, 6.39216995239258, 5.99972486495972, 
6.1301121711731, 6.89577865600586, 5.71755838394165, 5.61464166641235, 
7.37728309631348, 5.03542757034302, 6.49088478088379, 6.47503089904785, 
6.74515008926392, 6.21317529678345, 6.73602533340454, 5.83894491195679, 
6.03862571716309, 6.62425327301025, 6.48594427108765, 5.77535963058472, 
6.22002172470093, 6.44075727462769, 6.97933721542358, 5.99134588241577, 
5.90553331375122, 5.41966772079468, 6.4229588508606, 5.72843980789185, 
5.98337602615356, 7.09380102157593, 6.75640726089478, 6.17538690567017, 
6.41942977905273, 6.43869829177856, 6.32280206680298, 6.08922958374023, 
5.84972476959229, 4.59888076782227, 5.26190328598022, 6.76396989822388, 
5.68074369430542, 6.45128726959229, 5.80407381057739, 6.92664241790771, 
6.09139204025269, 5.06556510925293, 5.6678204536438, 5.94347715377808, 
6.43108367919922, 5.8886833190918, 6.76048898696899, 6.88852310180664, 
7.43118619918823, 6.41620302200317, 6.70113372802734, 6.58924293518066, 
6.66190767288208, 6.67980575561523, 5.89014434814453, 6.66620349884033, 
5.75310182571411, 6.31979179382324, 6.37364625930786, 6.54591751098633, 
6.51311635971069, 5.66882705688477, 6.44988203048706, 7.54567098617554, 
5.62305736541748, 7.08493375778198, 6.68084001541138, 7.3818678855896, 
6.48023223876953, 7.25512838363647, 6.25026512145996, 6.36538743972778, 
6.08377361297607, 5.82583618164062, 5.54729890823364, 6.47951698303223, 
7.11964845657349, 6.44115972518921, 5.71678447723389, 6.03122186660767, 
5.61665344238281, 6.28433418273926, 5.7384729385376, 6.16299104690552, 
6.50280523300171, 6.05133390426636, 5.89514350891113, 6.64010381698608, 
7.12322282791138, 6.96989822387695, 5.22721195220947, 6.31874752044678, 
6.35679244995117, 5.99329376220703, 5.77560186386108, 6.07549524307251, 
7.44583082199097, 7.14436435699463, 6.6331992149353, 7.13671445846558, 
6.64212369918823, 6.97420024871826, 6.36185646057129, 6.09386444091797, 
6.83703708648682, 6.73704385757446, 5.59871530532837, 6.72478818893433, 
5.90022706985474, 5.47119045257568, 6.33721256256104, 4.95647859573364, 
7.21758937835693, 6.72500419616699, 6.13663387298584, 6.87073564529419, 
7.03666639328003, 6.09523963928223, 6.05223608016968, 7.06237840652466, 
4.86405229568481, 6.19278287887573, 6.06442880630493, 4.23017597198486, 
5.78979110717773, 5.66751527786255, 6.11750936508179, 5.98377752304077, 
6.34869289398193, 6.19398784637451, 5.30345249176025, 6.47979497909546, 
6.74814033508301, 5.99444341659546, 6.04120016098022, 6.1256308555603, 
6.60186767578125, 6.76217555999756, 5.75423860549927, 7.92272901535034, 
6.29212093353271, 5.44476175308228, 6.04072237014771, 6.56123161315918, 
7.03037023544312, 6.00735235214233, 6.48824262619019, 6.29422283172607, 
6.29006433486938, 6.49364423751831, 6.07080364227295, 7.61194705963135, 
6.6091194152832, 6.99301052093506, 6.05143070220947, 5.06556510925293, 
6.51117420196533, 6.07625102996826, 6.67602014541626, 6.18730306625366, 
5.87532663345337, 6.07982635498047, 6.37113571166992, 5.61096715927124, 
5.83163213729858, 6.30789375305176, 6.30678796768188, 6.23096227645874, 
6.53492832183838, 6.06224870681763, 6.75879573822021, 6.28740882873535, 
6.41057157516479, 6.11259984970093, 7.75000047683716, 5.64584350585938, 
6.13561105728149, 7.10099458694458, 6.0057430267334, 5.94504356384277, 
6.08916521072388, 7.18280601501465, 7.23232698440552, 6.18873167037964, 
6.76160860061646, 7.17862939834595, 6.24671506881714, 6.61818790435791, 
7.11768245697021, 7.42846441268921, 6.24750089645386, 6.36669588088989, 
10.2105846405029, 5.52664613723755, 6.12972640991211, 6.09276390075684, 
7.49279928207397, 7.16222095489502, 6.60115957260132, 5.98962497711182, 
7.14379835128784, 6.22043991088867, 5.2158374786377, 6.03074741363525, 
6.89974784851074, 6.32616424560547, 7.07327175140381, 6.67165374755859, 
5.72631692886353, 6.83472013473511, 6.43379163742065, 4.87137222290039, 
7.31196784973145, 6.63792991638184, 5.58325719833374, 5.20819282531738, 
6.85068798065186, 5.82161235809326, 7.41396522521973, 6.76287889480591, 
5.62436676025391, 6.79405450820923, 7.4668025970459, 7.23443937301636, 
7.08593702316284, 6.13128614425659, 5.50188016891479, 7.19711017608643, 
6.78937768936157, 5.04307079315186, 7.0496940612793, 5.75035381317139, 
7.31696653366089, 6.70865869522095, 6.44787645339966, 6.4145712852478, 
6.5938549041748, 6.73318243026733, 6.608642578125, 5.6948094367981, 
6.32446527481079, 6.68627834320068, 5.33433294296265, 6.48418998718262, 
6.58874082565308, 5.73670625686646, 5.23733329772949, 5.88584613800049, 
6.26521015167236, 6.50940942764282, 6.03717088699341, 4.40988922119141, 
5.77093029022217, 6.0938720703125, 6.50231647491455, 6.55057287216187, 
6.43198585510254, 5.04179906845093, 6.15638732910156, 6.99443197250366, 
4.83275318145752, 6.29184293746948, 5.36022615432739, 6.90012311935425, 
7.3739218711853, 6.21808528900146, 6.51181221008301, 5.65778541564941, 
5.75415182113647, 6.03834581375122, 6.25316429138184, 5.84639024734497, 
6.26660251617432, 6.54931163787842, 6.86305904388428, 6.34693288803101, 
6.77213048934937, 5.96890258789062, 5.71333837509155, 5.30675840377808, 
7.74031972885132, 6.36995601654053, 5.72127628326416, 7.73841238021851, 
6.31050729751587, 6.37972784042358, 6.15952062606812, 6.45139169692993, 
7.26070594787598, 6.53641128540039, 5.8527684211731, 6.24848222732544, 
6.20839262008667, 6.54006099700928, 6.91716194152832, 5.15064239501953, 
6.61656618118286, 6.58095693588257, 6.07710599899292, 6.28569889068604, 
6.42024564743042, 6.12838745117188, 5.99336814880371, 7.66349935531616, 
6.63459396362305, 7.33552742004395, 6.41366291046143, 6.14867353439331, 
7.36985111236572, 5.99078130722046, 6.52826356887817, 6.07522678375244, 
5.78284740447998, 6.99725151062012, 6.99826335906982, 6.54737424850464, 
5.84593963623047, 6.58104753494263, 6.11439180374146, 6.17345762252808, 
5.86471748352051, 6.5969386100769, 6.26741218566895, 6.88043689727783, 
6.34168481826782, 6.47813367843628, 6.75934457778931, 6.54493474960327, 
5.81646966934204, 6.06914472579956, 6.09378480911255, 6.67693376541138, 
6.10323476791382, 6.51395416259766, 5.41068267822266, 7.17017984390259, 
6.3658504486084, 5.66032361984253, 5.919753074646, 6.23973512649536, 
6.37257099151611, 6.71847438812256, 6.56801700592041, 5.77721881866455, 
4.33596229553223, 5.79445838928223, 6.38703441619873, 5.96776103973389, 
6.03021860122681, 6.19542360305786, 5.34378051757812, 5.06908702850342, 
6.68856906890869, 6.75259017944336, 5.63706207275391, 7.53335428237915, 
6.9974479675293, 5.37654542922974, 6.49893808364868, 6.10504817962646, 
6.88088178634644, 7.92158508300781, 7.04019641876221, 6.50884914398193, 
6.19459867477417, 6.79138231277466, 7.64787817001343, 6.01577472686768, 
5.9994945526123, 6.58447360992432, 5.82486724853516, 5.8169960975647, 
6.20381784439087, 5.60301923751831, 5.79859399795532, 6.13930130004883, 
5.70750331878662, 7.08993911743164, 7.0128960609436, 6.39516878128052, 
6.14109945297241, 5.99465179443359, 7.00878381729126, 6.26266002655029, 
6.3066782951355, 6.45221757888794, 6.64610481262207, 6.84722232818604, 
6.23422050476074, 6.74361085891724, 7.62598133087158, 5.73876237869263, 
4.91390657424927, 6.15250825881958, 5.76505899429321, 6.12336874008179, 
6.48365879058838, 6.72583341598511, 6.06051778793335, 5.82934904098511, 
6.89144897460938, 6.34262466430664, 6.78861427307129, 6.53976202011108, 
7.41409254074097, 6.54663228988647, 6.27316474914551, 7.93451166152954, 
5.81067895889282, 6.62396001815796, 7.25826215744019, 7.38070917129517, 
6.02236032485962, 6.07457160949707, 6.15347290039062, 6.59111356735229, 
6.12774133682251, 6.61147165298462, 6.8123664855957, 6.37449073791504, 
5.86765623092651, 6.87702894210815, 7.49418544769287, 8.51651000976562, 
7.00790882110596, 6.00882244110107, 6.52730989456177, 7.1596508026123, 
6.94769144058228, 7.0427131652832, 6.19724082946777, 6.92268562316895, 
6.27651357650757, 6.71167707443237, 6.37842512130737, 5.78987216949463, 
6.27357006072998, 7.71938562393188, 6.65057897567749, 5.93438959121704, 
6.52883195877075, 5.56168460845947, 5.08413600921631, 6.39667224884033, 
6.35165500640869, 6.56768226623535, 6.01787757873535, 6.60938501358032, 
6.05804014205933, 5.8946852684021, 5.57552576065063, 6.4546971321106, 
7.00030755996704, 6.98061227798462, 5.52733945846558, 5.69868659973145, 
6.16402387619019, 6.82452011108398, 6.24885320663452, 6.08052396774292, 
6.25134897232056, 6.71951532363892, 5.08644342422485, 5.53612375259399, 
5.58702993392944, 6.37482595443726, 6.12532234191895, 6.21171426773071, 
6.39968299865723, 6.22678184509277, 4.61509418487549, 5.99854564666748, 
6.4367470741272, 7.10126686096191, 5.89162063598633, 6.08529996871948, 
5.76395463943481, 5.7112979888916, 5.41509819030762, 7.14358282089233, 
7.70044183731079, 8.39746284484863, 7.16165924072266, 6.17636060714722, 
6.13414812088013, 6.36619091033936, 6.15217447280884, 6.20758819580078, 
7.79125165939331, 7.04712247848511, 6.8487982749939, 6.73208427429199, 
7.39544439315796, 6.40667152404785, 6.37591075897217, 7.24078989028931, 
5.56391096115112, 6.85060119628906, 6.11024332046509, 7.27490186691284, 
6.67721509933472, 6.15044784545898, 6.81630754470825, 5.96839666366577, 
6.48517560958862, 6.12587451934814, 6.70129871368408, 5.16056346893311, 
5.77139520645142, 6.2334098815918, 6.15812730789185, 6.72866010665894, 
6.82464122772217, 6.07366228103638, 7.43183469772339, 7.85587406158447, 
7.42790746688843, 5.86768484115601, 6.41269683837891, 7.2634015083313, 
7.47485113143921, 5.74009275436401, 5.31495189666748, 6.20559692382812, 
6.391845703125, 6.68388557434082, 5.98225831985474, 5.29089784622192, 
6.62919521331787, 7.35223531723022, 7.73047685623169, 6.63155937194824, 
7.27876091003418, 6.14554119110107, 7.16189241409302, 5.7092604637146, 
6.41749620437622, 7.26062679290771, 7.85675525665283, 5.20213747024536, 
6.36795997619629, 5.20791149139404, 5.40984201431274, 6.91543674468994, 
6.1180419921875, 6.72407150268555, 5.87709379196167, 4.91404342651367, 
8.40792465209961, 5.72949886322021, 7.48850154876709, 5.93163728713989, 
7.13037967681885, 5.71771621704102, 5.37533664703369, 6.08360242843628, 
6.19923305511475, 6.49429988861084, 6.22375869750977, 6.34143495559692, 
6.62721967697144, 6.93273496627808, 6.75309753417969, 6.81405305862427, 
6.65460729598999, 6.52686834335327, 5.9545431137085, 6.19885921478271, 
6.80592393875122, 6.15113496780396, 6.45402908325195, 7.02782535552979, 
6.62931156158447, 5.79277658462524, 7.18628358840942, 7.25926494598389, 
7.10877323150635, 6.41757774353027, 5.15344095230103, 5.37121152877808, 
5.80060625076294, 6.43545150756836, 5.86441850662231, 4.94239187240601, 
6.23720693588257, 5.62386083602905, 6.86489534378052, 5.33734226226807, 
6.35895156860352, 5.56027603149414, 5.49889278411865, 5.09702682495117, 
6.73462581634521, 6.09275245666504, 6.02002954483032, 5.51949977874756, 
5.16892147064209, 6.00989389419556, 5.46915102005005, 6.46504259109497, 
6.85008716583252, 5.03845119476318, 6.4972767829895, 6.02233791351318, 
7.49533271789551, 5.45805501937866, 7.81691694259644, 6.39895343780518, 
6.57177305221558, 6.69132947921753, 6.77973461151123, 6.45517730712891, 
6.61084890365601, 7.14622688293457, 6.54600715637207, 6.53310537338257, 
6.44213390350342, 6.76409101486206, 6.54004907608032, 6.74990606307983, 
6.75505542755127, 6.59164094924927, 7.0796947479248, 5.80227088928223, 
6.08777666091919, 5.96428489685059, 5.87862873077393, 7.06425380706787, 
6.75353813171387, 6.84738636016846, 7.08529663085938, 6.3691611289978, 
6.67434597015381, 6.48998641967773, 6.03335094451904, 5.55971908569336, 
6.21996307373047, 7.1462574005127, 6.48018312454224, 5.85845518112183, 
7.11513662338257, 6.36537075042725, 6.64868783950806, 6.08682203292847, 
5.9484543800354, 6.41099834442139, 6.01827383041382, 5.37157821655273, 
5.66270351409912, 6.21729278564453, 7.38874626159668, 4.92912101745605, 
6.12006044387817, 6.8420524597168, 5.57153844833374, 6.36870574951172, 
6.45868253707886, 6.47313261032104, 6.38359642028809, 6.29279470443726, 
6.07687187194824, 5.61182594299316, 6.94852685928345, 5.48708343505859, 
8.61074924468994, 5.39208602905273, 6.83372116088867, 5.91611766815186, 
6.51640748977661, 6.73776292800903, 6.18237829208374, 5.55932569503784, 
6.40241479873657, 6.09835577011108, 6.24187421798706, 6.63305950164795, 
6.55369329452515, 7.70435190200806, 6.87130832672119, 6.14526891708374, 
6.35646295547485, 5.98575592041016, 6.10371446609497, 6.11825370788574, 
6.58971691131592, 6.80215740203857, 6.80286264419556, 8.05160713195801, 
6.42741823196411, 6.22552585601807, 5.65692472457886, 7.23162174224854, 
7.69785642623901, 6.26617908477783, 6.48871564865112, 6.59785318374634, 
6.39413261413574, 5.26404523849487, 5.75703001022339, 6.22727155685425, 
6.25949764251709, 6.88752365112305, 6.43391990661621, 6.72896671295166, 
7.01510763168335, 7.35990190505981, 6.02744913101196, 5.94736528396606, 
5.84606790542603, 6.91974925994873, 7.10168027877808, 6.73441362380981, 
6.35972118377686, 5.58065605163574, 6.4261302947998, 6.08554649353027, 
6.88528680801392, 6.81980180740356, 6.3918023109436, 6.90047645568848, 
7.43612337112427, 6.28338718414307, 5.95270395278931, 6.17569780349731, 
6.20358085632324, 6.15603256225586, 5.38640069961548, 6.51811361312866, 
5.258469581604, 5.22803592681885, 5.70856666564941, 6.04634571075439, 
6.18571996688843, 5.32768487930298, 6.56538105010986, 5.86724805831909, 
5.64291477203369, 7.45154428482056, 6.31921291351318, 6.20135498046875, 
6.42492008209229, 7.29791641235352, 6.51796102523804, 5.63509464263916, 
6.88346576690674, 6.16627550125122, 6.91012048721313, 6.56624746322632, 
5.61434507369995, 5.91756582260132, 5.79381942749023, 7.32715940475464, 
5.34676885604858, 5.84888172149658, 7.37831544876099, 6.43409252166748, 
6.77331733703613, 7.06120347976685, 6.58605813980103, 7.04293060302734, 
7.23181295394897, 6.14799642562866, 6.57881259918213, 7.64114475250244, 
5.75438642501831, 6.57071685791016, 6.80921840667725, 5.79066038131714, 
6.57936191558838, 6.12655878067017, 6.46099805831909, 5.75869655609131, 
5.8860912322998, 6.54729747772217, 5.89190626144409, 6.2282886505127, 
5.56995391845703, 6.64630270004272, 5.33448171615601, 6.44594240188599, 
6.68448686599731, 6.61454153060913, 6.40591669082642, 7.48210000991821, 
5.28046369552612, 6.81575298309326, 6.28933000564575, 6.14200210571289, 
6.38580131530762, 5.59747314453125, 7.27891063690186, 5.73867130279541, 
6.93151760101318, 6.6683988571167, 6.52905797958374, 5.82483434677124, 
6.06571912765503, 6.3262677192688, 7.41303491592407, 6.48056030273438, 
6.003089427948, 6.86686086654663, 5.77881622314453, 6.24719762802124, 
8.32923698425293, 7.39432525634766, 5.51310682296753, 6.57414102554321, 
6.16744422912598, 7.21188879013062, 5.82593250274658, 5.75042772293091, 
7.45689964294434, 6.61333274841309, 6.75947999954224, 6.16875219345093, 
6.8760838508606, 7.8192892074585, 4.56591176986694, 5.35139036178589, 
6.11516857147217, 6.67163801193237, 6.98033285140991, 6.855140209198, 
7.55933666229248, 6.27696943283081, 6.64891910552979, 6.06071186065674, 
7.34640216827393, 6.10901355743408, 7.0786657333374, 7.36089277267456, 
7.03552484512329, 5.36298751831055, 6.15639925003052, 6.48574352264404, 
4.8097939491272, 6.68119430541992, 6.69965982437134, 6.42316007614136, 
6.22979068756104, 7.24534130096436, 7.25708913803101, 7.79575777053833, 
6.94106721878052, 6.77881097793579, 6.71771478652954, 6.70705127716064, 
7.51645183563232, 4.45007991790771, 6.35825538635254, 6.57207155227661, 
6.19291067123413, 6.78567171096802, 6.77833890914917, 6.88450717926025, 
5.87920331954956, 6.1806378364563, 6.48058795928955, 7.8080792427063, 
6.6626763343811, 5.59953641891479, 4.11396598815918, 6.69471168518066, 
7.28207302093506, 9.21781539916992, 6.23116540908813, 7.12337160110474, 
6.84371137619019, 6.07801103591919, 6.44441938400269, 8.50888252258301, 
7.19771385192871, 6.48560619354248, 6.21359968185425, 5.97071599960327, 
7.26014757156372, 5.83497905731201, 5.62706995010376, 6.98293828964233, 
5.98720264434814, 6.73169898986816, 6.03751420974731, 6.43914031982422, 
8.76976013183594, 6.48334884643555, 6.02384757995605, 6.71156167984009, 
5.80301856994629, 5.24157619476318, 5.94637060165405, 4.94704818725586, 
5.96599674224854, 5.72742366790771, 6.49525022506714, 6.31558656692505, 
5.76492023468018, 5.40403747558594, 5.3251166343689, 5.63355731964111, 
8.87822532653809, 5.82521200180054, 6.06578159332275, 5.83860445022583, 
6.26448917388916, 6.53798007965088, 6.39747858047485, 5.89243793487549, 
6.27336025238037, 6.07973194122314, 5.31201314926147, 6.1113486289978, 
6.7971715927124, 5.73472213745117, 7.68283319473267, 7.10289573669434, 
5.91789674758911, 6.07174015045166, 6.25598192214966, 5.48130130767822, 
6.39980840682983, 5.80963850021362, 6.22212362289429, 6.45786476135254, 
7.34519290924072, 6.30002117156982, 8.21387386322021, 6.09575128555298, 
6.5310263633728, 7.30942630767822, 5.66496086120605, 6.87929534912109, 
5.63749361038208, 6.42056655883789, 6.77143669128418, 5.06556510925293, 
6.24597549438477, 6.54535341262817, 6.22780561447144, 7.04226207733154, 
7.36156368255615, 6.32316398620605, 6.38295841217041, 7.10218715667725, 
6.29469680786133, 5.76555776596069, 6.28888177871704, 6.81797027587891, 
6.94383144378662, 6.80977725982666, 6.7137451171875, 6.32257747650146, 
5.28352928161621, 6.80693531036377, 6.80259084701538, 6.24436473846436, 
5.45171499252319, 7.04271793365479, 6.10914421081543, 6.77490663528442, 
6.50501823425293, 5.46444129943848, 6.60292100906372, 7.76737689971924, 
6.25127649307251, 8.38349342346191, 5.76872777938843, 6.86781024932861, 
5.74212074279785, 6.97255659103394, 5.49559450149536, 6.28624153137207, 
7.33709239959717, 7.60196018218994, 6.42497777938843, 6.61771678924561, 
6.17572212219238, 6.90017747879028, 6.55238628387451, 6.52157402038574, 
7.01943206787109, 5.74548244476318, 5.66915845870972, 6.27200889587402, 
6.50773048400879, 6.42642164230347, 6.00254011154175, 7.29683256149292, 
6.40733242034912, 6.01075410842896, 6.38117361068726, 6.3177318572998, 
4.75511932373047, 5.82277679443359, 5.44628810882568, 6.12369012832642, 
6.50811243057251, 6.71882152557373, 6.82700395584106, 5.48629093170166, 
6.36388540267944, 5.64409589767456, 9.07087516784668, 6.92039155960083, 
5.86768913269043, 8.32542896270752, 6.43388652801514, 5.9977388381958, 
5.92418003082275, 6.69156789779663, 5.83671140670776, 6.55323457717896, 
6.10620546340942, 7.06188774108887, 6.33715915679932, 5.70903396606445, 
6.09392833709717, 5.7153697013855, 7.55614566802979, 5.43555116653442, 
5.69351816177368, 5.7667441368103, 6.20702219009399, 6.89055204391479, 
5.76478147506714, 6.7985463142395, 5.92928886413574, 5.94762325286865, 
6.39367008209229, 6.35234928131104, 6.93163013458252, 6.07296514511108, 
5.75069141387939, 5.50465536117554, 7.98763990402222, 6.26689338684082, 
5.96743679046631, 6.28222036361694, 6.69336748123169, 5.3647403717041, 
6.51265239715576, 8.31559944152832, 5.70417833328247, 6.12356948852539, 
7.4298243522644, 5.8612642288208, 6.23203992843628, 8.48253154754639, 
6.23920679092407, 6.60543775558472, 4.84177255630493, 6.4614086151123, 
6.42717123031616, 6.81813192367554, 5.04504203796387, 6.54267120361328, 
7.33603429794312, 6.00602674484253, 6.07674741744995, 5.25874280929565, 
4.98073434829712, 5.53112077713013, 6.34931468963623, 6.81587314605713, 
5.88098669052124, 6.46307897567749, 6.23014259338379, 6.58262920379639, 
6.70951700210571, 6.16413879394531, 6.80804491043091, 5.80955505371094, 
6.33286666870117, 5.44878387451172, 7.41345643997192, 6.52606248855591, 
6.37579107284546, 6.11947584152222, 6.70318460464478, 6.59876728057861, 
6.3247013092041, 4.81977128982544, 6.24560022354126, 6.37287759780884, 
7.21579504013062, 5.46247005462646, 5.39950847625732, 6.2937445640564, 
6.44590950012207, 6.43221759796143, 8.19199752807617, 6.0107946395874, 
6.42058658599854, 6.16335296630859, 5.76805305480957, 6.70481252670288, 
6.83150959014893, 6.47882127761841, 6.37465667724609, 5.26971530914307, 
6.88511514663696, 5.28620481491089, 5.45650863647461, 6.20274972915649, 
7.17831325531006, 7.11473989486694, 6.86806011199951, 6.61987781524658, 
8.15552806854248, 5.39730453491211, 5.78829574584961, 6.48743486404419, 
5.92658519744873, 7.80739784240723, 6.00987482070923, 6.72588777542114, 
5.6640796661377, 6.05108642578125, 5.02398586273193, 6.26258707046509, 
6.78068447113037, 8.43548965454102, 6.37761688232422, 7.22483777999878, 
6.82362747192383, 6.16625165939331, 6.70108938217163, 6.43508672714233, 
6.71562623977661, 5.74382066726685, 6.67856550216675, 6.17656898498535, 
7.03724431991577, 7.5893759727478, 7.092942237854, 7.0881462097168, 
6.23222589492798, 7.21678590774536, 6.71923685073853, 6.93695974349976, 
6.78612661361694, 5.55221366882324, 5.3857250213623, 5.24579524993896, 
4.84002256393433, 6.1720986366272, 6.22998285293579, 6.18685674667358, 
6.11340045928955, 7.03725242614746, 5.63247537612915, 6.73168849945068, 
6.0743203163147, 5.94340801239014, 5.53019857406616, 6.69651937484741, 
5.65310764312744, 5.68894720077515, 6.29484701156616, 6.40782260894775, 
6.32065153121948, 5.8619532585144, 8.16123867034912, 5.35785150527954, 
8.64839363098145, 6.75808715820312, 5.79922914505005, 5.70824575424194, 
5.62243175506592, 6.57849550247192, 6.52363634109497, 5.50522994995117, 
6.60226535797119, 5.97910404205322, 6.60084009170532, 5.44848012924194, 
6.16656446456909, 8.00881767272949, 6.56164264678955, 6.95548009872437, 
5.06222105026245, 7.36478233337402, 6.32865905761719, 6.96272373199463, 
5.79444217681885, 6.33874130249023, 6.5997142791748, 6.59254789352417, 
7.4986457824707, 7.6706805229187, 6.03820466995239, 6.50300264358521, 
7.14568662643433, 6.7009220123291, 4.68594169616699, 5.2928318977356, 
7.57969284057617, 6.08337879180908, 6.30854082107544, 5.9985785484314, 
6.90087509155273, 5.64103698730469, 7.41598749160767, 7.05274820327759, 
7.11978769302368, 7.29520511627197, 5.96187543869019, 6.62102842330933, 
7.03283786773682, 7.84762287139893, 6.21435976028442, 5.78466606140137, 
6.01237106323242, 7.20572376251221, 7.05832815170288, 6.42959690093994, 
4.71256589889526, 7.5393648147583, 6.34930086135864, 6.82702541351318, 
5.7716646194458, 5.88974952697754, 5.68867301940918, 6.92174577713013, 
6.52064418792725, 5.89677715301514, 6.90131330490112, 7.04930448532104, 
6.53185129165649, 6.08625984191895, 6.12948513031006, 6.06489849090576, 
6.28670930862427, 5.89473724365234, 6.29965114593506, 5.14908218383789, 
6.98155689239502, 6.0850133895874, 7.11566162109375, 6.81516742706299, 
6.07801866531372, 9.4543571472168, 7.81473445892334, 7.79862070083618, 
5.93472576141357, 5.90916347503662, 6.85867404937744, 6.61033582687378, 
6.49887084960938, 6.03266620635986, 5.64496850967407, 6.56739330291748, 
5.81750059127808, 6.36032485961914, 6.46280002593994, 5.88090705871582, 
5.88656902313232, 8.0873908996582, 6.44256782531738, 7.56667566299438, 
6.18455028533936, 5.93845701217651, 5.91271448135376, 5.03638744354248, 
7.19360637664795, 5.63889169692993, 7.21849203109741, 5.94027900695801, 
6.47017192840576, 7.17682790756226, 6.45954751968384, 6.08631610870361, 
6.37553215026855, 4.73138809204102, 6.99886131286621, 5.27629089355469, 
6.02591896057129, 5.34855937957764, 5.82272911071777, 7.08208322525024, 
5.81958150863647, 6.41349506378174, 4.21824741363525, 5.93385028839111, 
4.85627698898315, 6.54467010498047, 6.34648847579956, 6.71512603759766, 
6.79649782180786, 5.61082649230957, 6.80599594116211, 5.64035606384277, 
5.9426064491272, 6.17085599899292, 5.69650840759277, 6.80089330673218, 
6.55794286727905, 6.42280435562134, 6.22510957717896, 6.1634669303894, 
6.64427757263184, 6.22854804992676, 6.60216331481934, 6.08956336975098, 
6.3425350189209, 7.44915246963501, 6.7419638633728, 5.90182018280029, 
6.1460075378418, 5.74064636230469, 6.12799119949341, 6.32844400405884, 
6.23707914352417, 6.36856031417847, 6.1794114112854, 7.25050163269043, 
6.43342876434326, 6.50158977508545, 6.01999616622925, 7.38031482696533, 
7.47113370895386, 7.1413369178772, 6.81969213485718, 5.79584789276123, 
5.91673040390015, 5.80245113372803, 6.09799718856812, 6.37585353851318, 
4.62270927429199, 6.00698280334473, 6.20451164245605, 6.64121198654175, 
6.82106494903564, 6.50988578796387, 7.01588153839111, 7.28947925567627, 
6.65068531036377, 5.89283323287964, 5.81441926956177, 7.36732149124146, 
5.08727884292603, 5.70026016235352, 7.37361526489258, 5.68989706039429, 
6.65034580230713, 6.67695474624634, 6.69407176971436, 6.01105117797852, 
6.75482606887817, 6.12492322921753, 5.51153802871704, 6.15742111206055, 
5.28457403182983, 6.42001581192017, 6.62318992614746, 6.71705198287964, 
7.25225734710693, 6.40164375305176, 6.83687257766724, 5.79028511047363, 
6.63579702377319, 7.72173881530762, 6.35350608825684, 5.9301323890686, 
6.33206701278687, 6.25576162338257, 6.2772479057312, 5.46625280380249, 
6.66514492034912, 6.76688098907471, 5.08923101425171, 5.86113786697388, 
7.93854522705078, 5.5420503616333, 6.83385848999023, 5.80533218383789, 
6.81745624542236, 5.8903751373291, 5.93274354934692, 5.8421950340271, 
5.96553993225098, 6.31301021575928, 6.74512100219727, 6.82312202453613, 
6.0212345123291, 6.32896137237549, 6.71857404708862, 5.39644145965576, 
8.16975593566895, 7.11519145965576, 6.64619159698486, 6.22053003311157, 
7.03390645980835, 6.29871034622192, 7.21655225753784, 5.70807456970215, 
6.27337789535522, 5.19792509078979, 6.16105175018311, 6.57584524154663, 
6.036057472229, 6.44254875183105, 7.27542352676392, 6.03401899337769, 
5.88913059234619, 6.46673440933228, 6.1181001663208, 6.06361150741577, 
6.03286218643188, 6.33054828643799, 6.30833625793457, 6.26895380020142, 
5.88706159591675, 6.74954891204834, 7.21431303024292, 6.36887693405151, 
7.12827682495117, 6.60357236862183, 6.14612531661987, 6.75682830810547, 
6.02526092529297, 6.36705589294434, 6.23407173156738, 6.30369186401367, 
5.95156478881836, 6.20468807220459, 5.97415781021118, 7.89034795761108, 
6.1963939666748, 5.55823373794556, 5.8030309677124, 5.48341512680054, 
6.9861741065979, 6.39409685134888, 6.90698099136353, 6.73342895507812, 
5.91550827026367, 6.32190942764282, 6.45819616317749, 5.82915782928467, 
6.56250524520874, 6.98038530349731, 6.45367813110352, 7.09405422210693, 
6.07207727432251, 4.77878189086914, 5.49700355529785, 5.8923282623291, 
5.2875189781189, 5.20450448989868, 7.17451000213623, 6.61001634597778, 
8.17100143432617, 7.50485610961914, 5.70846891403198, 7.46729516983032, 
5.75208282470703, 6.3176703453064, 6.29461860656738, 5.74905633926392, 
6.46652269363403, 6.14493799209595, 6.85380411148071, 6.79268217086792, 
7.48591375350952, 5.81263446807861), .Dim = c(1997L, 1L))
```

```{r}
risco_redes=(predito_redes-filmes$vote_average[split=="Teste"])^2 %>% mean()
risco_redes

W_redes<-(predito_redes - filmes$vote_average[split=="Teste"])^2
sigma2_redes<- (W_redes- mean(W_redes))^2%>%mean()
erro_padrao_redes<- sqrt(sigma2_redes/m)
erro_padrao_redes

```

Observa-se que o risco de redes neurais, não é o melhor para os dados em relação aos outros métodos. Ele é bem semelhante ao resultado obtido pelo KNN e seu erro padrão também é maior em relação aos demais (sendo um pouco menor que o do Lasso).

## Item H

Os gráficos dos valores preditos contra os observados para cada método são apresentados a seguir:

```{r}

#knn

ggplot(data.frame(predito,observado=filmes$vote_average[split=="Teste"]),
       aes(x=observado,y=predito))+
  geom_point(col="red")+ 
  geom_abline(slope = 1,intercept = 0, col="black")+
  ggtitle("KNN")+
  theme_classic()


#lasso
ggplot(data.frame(predito_lasso,observado=filmes$vote_average[split=="Teste"]),
       aes(x=observado,y=predito_lasso) )+
  geom_point(col="red")+ 
  geom_abline(slope = 1,intercept = 0, col="black")+
    ggtitle("Lasso")+
  theme_classic()

#floresta
ggplot(data.frame(predito_floresta$predictions,
       observado=filmes$vote_average[split=="Teste"]),
       aes(x=observado,y=predito_floresta$predictions))+
  geom_point(col="red")+ ylab("Valores Preditos")+xlab("Valores observados")+
  theme_classic()+
  ggtitle("Floresta aleatória")+
  geom_abline(slope = 1,intercept = 0, col="black")

#Redes neurais
ggplot(data.frame(predito_redes,observado=filmes$vote_average[split=="Teste"]),
       aes(x=observado,y=predito_redes))+
  geom_point(col="red")+ ylab("Valores Preditos")+xlab("Valores observados")+
  theme_classic()+
  ggtitle("Redes neurais")+
  geom_abline(slope = 1,intercept = 0, col="black")

```

Verificamos se o método realmente está adequado aos dados, quando o valor predito estiver próximo do observado, isto é, os pontos devem estar próximos da reta identidade. Porém, neste caso, identificamos que todos os gráficos se encontram com os pontos bem dispersos ao redor da reta, estando alguns mais espalhados (como o KNN), mostrando um comportamento ruim. Os valores do Lasso e das Redes neurais se encontram mais concentrados no centro, enquanto o da Floresta é um dos que se destacam por ter seus pontos mais na parte de cima da reta.

## Item I

Podemos comparar os Riscos estimados e o Erro padrão para cada modelo ajustado a seguir:

```{r}

#riscos

riscos<- c(riscos_knn, risco_lasso,risco_floresta,risco_boost,risco_redes) #risco_xgboost
erros_padrao<-c(erro_padrao_knn,erro_padrao_lasso,
                erro_padrao_flo,erro_padrao_boost, erro_padrao_redes)


riscos_erro<- data.frame(riscos,erros_padrao)
row.names(riscos_erro)<-c("KNN","Lasso","Floresta","XGBoost","Redes Neurais")
                          
  
colnames(riscos_erro)<-c("Risco preditivo","Erro Padrão")
riscos_erro %>% knitr::kable(align = "c")

```

Seguindo as interpretações feitas até o momento a respeito do **risco**, temos que o melhor modelo é o da Floresta Aleatória, pois obteve-se o menor risco dentre todos os métodos (1.6477), fornecendo indícios de que as interpretações feitas até então, estavam corretas. Vale ressaltar que o ajuste realizado com a Floresta obteve um risco bem próximo ao do Lasso (1.6706), com um erro padrão um pouco inferior. 

A técnica do KNN foi a que teve o maior risco, seguida das redes neurais e do XGBoost.  O motivo do pior desempenho do KNN, nesse exemplo, é que este método não realiza a seleção de covariáveis e muitas dessas não são importante para contribuir com a nota dada aos filmes.

Levando em consideração as **interpretações** com coeficientes e importância, identificamos que no método da Floresta, as palavras de importância são artigos, pronomes ou aquelas que não acrescentam tanto ao ajuste. Quando esse método se compara com o do Lasso e do XGBoost, obtém-se um número maior de palavras que têm verdadeiro impacto no modelo, tornando possível uma pré identificação do gênero do filme em relação a nota atribuída.

Levando em consideração o risco, erro e interpretação do modelo, o ajuste que mais demonstrou ser adequado foi o do Lasso, pois apresentou valores de erro e risco muito próximos ao da Floresta e uma melhor interpretabilidade dos coeficientes em relação aos demais. Caso decidirmos levar somente os dois primeiros pontos em consideração, o modelo mais adequado torna-se o da Floresta. Vale destacar que o XGBoost também apresentou valores próximos destes dois métodos, sendo um erro padrão inferior ao Lasso. Por ser um método não paramétrico, esta técnica é mais flexível e, possivelmente, o ajuste dos tuning parameters dessa função pode levar a um melhor desempenho deste modelo.
